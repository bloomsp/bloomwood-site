---
import { ThemeToggle } from './ThemeToggle';
import { SiteNav, type NavItem } from './SiteNav';

export interface Props {
  homeHref?: string;
  brandLabel?: string;
  logoSrc?: string;
  logoAlt?: string;
  nav?: NavItem[];
}

const {
  homeHref = '/',
  brandLabel = 'Bloomwood',
  logoSrc = '/logo.svg',
  logoAlt = brandLabel,
  nav = [],
} = Astro.props;
---

<header class="border-b border-border">
  <div class="mx-auto flex max-w-5xl items-center justify-between gap-4 px-4 py-4">
    <a href={homeHref} class="flex min-w-0 items-center gap-3">
      <img src={logoSrc} alt={logoAlt} class="h-10 w-auto" loading="eager" />
      <span class="truncate text-lg font-semibold font-[Raleway]">{brandLabel}</span>
    </a>

    {/* Desktop nav */}
    <nav class="hidden items-center gap-2 md:flex">
      <SiteNav nav={nav} client:load />
      <ThemeToggle client:load />
    </nav>

    {/* Mobile nav (hamburger) */}
    <div class="flex items-center gap-2 md:hidden">
      <ThemeToggle client:load />
      <details class="relative">
        <summary
          class="list-none rounded-lg border border-border bg-background p-2 text-muted-foreground hover:bg-accent hover:text-accent-foreground"
          aria-label="Open menu"
        >
          <span class="sr-only">Menu</span>
          <svg
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
            class="h-5 w-5"
            aria-hidden="true"
          >
            <path d="M4 6h16" />
            <path d="M4 12h16" />
            <path d="M4 18h16" />
          </svg>
        </summary>

        <div class="absolute right-0 z-50 mt-2 w-72 rounded-xl border border-border bg-background p-2 shadow-lg">
          {nav.map((i) => (
            'items' in i ? (
              <div class="px-2 py-2" key={i.label}>
                <div class="px-1 pb-1 text-xs font-semibold text-muted-foreground">{i.label}</div>
                <div class="grid gap-1">
                  {i.items.map((sub) => (
                    <a
                      class="block rounded-lg px-3 py-2 text-sm text-muted-foreground hover:bg-accent hover:text-accent-foreground"
                      href={sub.href}
                    >
                      {sub.label}
                    </a>
                  ))}
                </div>
              </div>
            ) : (
              <a
                class="block rounded-lg px-3 py-2 text-sm text-muted-foreground hover:bg-accent hover:text-accent-foreground"
                href={i.href}
                key={i.href}
              >
                {i.label}
              </a>
            )
          ))}
        </div>
      </details>
    </div>
  </div>
</header>
