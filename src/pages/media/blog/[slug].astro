---
import { getCollection } from 'astro:content';
import PageLayout from '../../../layouts/PageLayout.astro';

export const prerender = true;

export async function getStaticPaths() {
  const posts = await getCollection('blog', ({ data }) => !data.draft);
  return posts
    .filter((p) => p.slug.startsWith('media/'))
    .map((p) => ({ params: { slug: p.slug.replace(/^media\//, '') }, props: { post: p } }));
}

const { post } = Astro.props;
const { Content } = await post.render();
---

<PageLayout title={post.data.title} description={post.data.description}>
  <header class="mb-8 not-prose">
    <h1 class="text-3xl font-semibold tracking-tight">{post.data.title}</h1>
    <div class="mt-2 text-sm text-muted-foreground">
      {post.data.pubDate.toLocaleDateString('en-AU', { year: 'numeric', month: 'long', day: 'numeric' })}
      {post.data.author ? ` â€¢ ${post.data.author}` : ''}
    </div>
  </header>

  <Content />
</PageLayout>
